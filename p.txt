
az rest --method post \
  --url "https://management.azure.com/subscriptions/<SUBSCRIPTION_ID>/resourceGroups/<RESOURCE_GROUP>/providers/Microsoft.ApiManagement/service/<APIM_NAME>/namedValues/<NAMED_VALUE_ID>/refreshSecret?api-version=2024-05-01"



revisionId="YourRevisionNumber"
# URL targets the policy within the specific API revision resource
APIM_URL="/subscriptions/$subscriptionId/resourceGroups/$resourceGroup/providers/Microsoft.ApiManagement/service/$serviceName/apis/$apiName/revisions/$revisionId/policies/policy?api-version=$API_VERSION"

az rest --method get --url "$APIM_URL" --query properties.value -o tsv > "$FilePath"

echo "Policy for API '$apiName' revision '$revisionId' saved to: $FilePath"



LIST_URL="/subscriptions/$subscriptionId/resourceGroups/$resourceGroup/providers/Microsoft.ApiManagement/service/$serviceName/apis/$apiName/revisions?api-version=$API_VERSION"

# 2. Execute the GET request to list them
az rest --method get --url "$LIST_URL" --query "value[*].name" -o tsv
